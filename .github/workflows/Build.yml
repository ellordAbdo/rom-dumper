name: Extract and upload compressed archive

on:
  push:
    branches:
      - main

jobs:
  extract:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Download compressed archive
        run: curl -L https://ava4.androidfilehost.com/dl/sesqszx6h-Vq_dMy1DDvvw/1690015461/10763459528675576300/Infinix_Zero_8_X657C_MT6761_V124_200806.zip -o rom.zip

      - name: Extract compressed archive
        run: unzip rom.zip
        
      - name: Install dependencies
        run: sudo apt-get update && sudo apt-get install -y git wget

      - name: Upload all decompressed files to releases page
        run: |
          ls
          ls *
          cd Infinix_Zero_8_X657C_MT6761_V124_200806/Firmware/
          for file in $(find . -type f); do
            upload-release-asset \
              repo_token=${{ secrets.GITHUB_TOKEN }} \
              tag=${{ github.ref }} \
              asset_name=${file} \
              file=${file}
          done
